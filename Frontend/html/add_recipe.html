<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Recipe</title>
    <link rel="stylesheet" href="../css/add_recipe.css">
    <link rel="stylesheet" href="../css/toast.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <img src="../image/logo.jpg" alt="MystryMenu Logo" class="logo">
        </div>
        <div class="content">
            <div class="profile-header">
                <div class="heading">            
                    <img src="../image/addrep.png" alt="Icon" class="icon">
                    <h2>Add Recipe</h2>
                    <div class="form-group">
                        <label for="image-upload" class="image-upload">
                          <div class="upload-placeholder">
                            <img src="../image/addimg.png" alt="Add Image Icon" class="add-image-icon" id="preview-image">
                            <span>Recipe Image</span>
                          </div>
                          <input type="file" id="image-upload" name="recipe-image" accept="image/*" onchange="previewImage(this)">
                        </label>
                    </div>
                </div>               
            </div>
            <form id="recipeForm" class="form" action="../../backend/addRecipe.php" method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <div class="form-group">
                        <label for="recipe-name">Recipe Name</label>
                        <input type="text" id="recipe-name" name="recipe-name" placeholder="Enter recipe name" required>
                    </div>
                    <div class="form-group">
                        <label for="type">Type</label>
                        <select id="type" name="type" required>
                          <option value="">Select Type</option>
                          <option>Breakfast</option>
                          <option>Lunch</option>
                          <option>Dinner</option>
                          <option>Vegetarian</option>
                          <option>Sweets</option>
                          <option>Drinks</option>
                          <option>Cakes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="ingredient">Ingredient</label>
                        <input type="text" id="ingredient" name="ingredient" placeholder="Enter ingredients" required>
                    </div>
                    <div class="form-group">
                        <label for="method">Method</label>
                        <textarea id="method" name="method" placeholder="Enter cooking method" required></textarea>
                    </div>
                    <div class="button-group">
                        <button type="button" class="cancel" onclick="window.history.back()">Cancel</button>
                        <button type="submit" class="add">Add</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script>
        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('preview-image').src = e.target.result;
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 7000);
        }

        document.getElementById('recipeForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);

            fetch('../../backend/addRecipe.php', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showToast(data.message, 'success');
                    this.reset();
                    document.getElementById('preview-image').src = '../image/addimg.png';
                    setTimeout(() => {
                        window.location.href = 'profile.html';
                    }, 2000);
                } else {
                    showToast(data.message, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showToast('An error occurred while submitting the recipe', 'error');
            });
        });
    </script>
    <div id="toast" class="toast"></div>
</body>
</html>
